{"version":3,"sources":["../src/variables.js"],"names":["Variables","templateSrv","target","options","variables","scopedVars","variableNames","match","resolved","forEach","values","getVarValues","name","newResolved","push","replace","val","map","v","join","charAt","substring","length","split","variableExists"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2BAAaA,S;AAEX,2BAAYC,WAAZ,EAAyB;AAAA;;AACvB,eAAKA,WAAL,GAAmBA,WAAnB;AACD;;;;kCAEOC,M,EAAQC,O,EAAS;AAAA;;AACvB,gBAAMC,YAAYD,QAAQE,UAAR,IAAsB,KAAKJ,WAAL,CAAiBG,SAAzD;AACA;AACA,gBAAME,gBAAgBJ,OAAOK,KAAP,CAAa,QAAb,CAAtB;AACA,gBAAIC,WAAW,CAACN,MAAD,CAAf;AACA,gBAAII,aAAJ,EAAmB;AACjBA,4BAAcG,OAAd,CAAsB,gBAAQ;AAC5B,oBAAMC,SAAS,MAAKC,YAAL,CAAkBC,IAAlB,EAAwBR,SAAxB,CAAf;AACA,oBAAMS,cAAc,EAApB;AACAH,uBAAOD,OAAP,CAAe,eAAO;AACpBD,2BAASC,OAAT,CAAiB,kBAAU;AACzBI,gCAAYC,IAAZ,CAAiBZ,OAAOa,OAAP,CAAeH,IAAf,EAAqBI,GAArB,CAAjB;AACD,mBAFD;AAGD,iBAJD;AAKAR,2BAAWK,WAAX;AACD,eATD;AAUD;AACD,mBAAOL,QAAP;AACD;;;0CAEeN,M,EAAQC,O,EAAS;AAAA;;AAC/B,gBAAMC,YAAYD,QAAQE,UAAR,IAAsB,KAAKJ,WAAL,CAAiBG,SAAzD;AACA,mBAAOF,OAAOa,OAAP,CAAe,QAAf,EAAyB,gBAAQ;AACtC,kBAAML,SAAS,OAAKC,YAAL,CAAkBC,IAAlB,EAAwBR,SAAxB,CAAf;AACA,qBAAOM,OAAOO,GAAP,CAAW;AAAA,uBAAK,MAAMC,CAAN,GAAU,GAAf;AAAA,eAAX,EAA+BC,IAA/B,CAAoC,GAApC,CAAP;AACD,aAHM,CAAP;AAID;;;uCAEYP,I,EAAMR,S,EAAW;AAC5B,gBAAMM,SAAS,KAAKT,WAAL,CAAiBc,OAAjB,CAAyBH,IAAzB,EAA+BR,SAA/B,CAAf;AACA;AACA,gBAAIM,OAAOU,MAAP,CAAc,CAAd,MAAqB,GAAzB,EAA8B;AAC1B,qBAAOV,OAAOW,SAAP,CAAiB,CAAjB,EAAoBX,OAAOY,MAAP,GAAc,CAAlC,EAAqCC,KAArC,CAA2C,GAA3C,CAAP;AACH;AACD,mBAAO,CAACb,MAAD,CAAP;AACD;;;iCAEME,I,EAAM;AACX,mBAAO,KAAKX,WAAL,CAAiBuB,cAAjB,CAAgCZ,IAAhC,CAAP;AACD","file":"variables.js","sourcesContent":["export class Variables {\n\n  constructor(templateSrv) {\n    this.templateSrv = templateSrv;\n  }\n\n  resolve(target, options) {\n    const variables = options.scopedVars || this.templateSrv.variables;\n    // For each variable in target, and each values of a given variable, build a resolved target string\n    const variableNames = target.match(/\\$\\w+/g);\n    let resolved = [target];\n    if (variableNames) {\n      variableNames.forEach(name => {\n        const values = this.getVarValues(name, variables);\n        const newResolved = [];\n        values.forEach(val => {\n          resolved.forEach(target => {\n            newResolved.push(target.replace(name, val));\n          });\n        });\n        resolved = newResolved;\n      });\n    }\n    return resolved;\n  }\n\n  resolveToString(target, options) {\n    const variables = options.scopedVars || this.templateSrv.variables;\n    return target.replace(/\\$\\w+/g, name => {\n      const values = this.getVarValues(name, variables);\n      return values.map(v => \"'\" + v + \"'\").join(',');\n    });\n  }\n\n  getVarValues(name, variables) {\n    const values = this.templateSrv.replace(name, variables);\n    // result might be in like \"{id1,id2,id3}\" (as string)\n    if (values.charAt(0) === '{') {\n        return values.substring(1, values.length-1).split(',');\n    }\n    return [values];\n  }\n\n  exists(name) {\n    return this.templateSrv.variableExists(name);\n  }\n}\n"]}